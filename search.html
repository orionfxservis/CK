<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Search - ClickWorx</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="style.css">
  <style>
    /* Hero Section */
    .hero { margin-top:70px; height:70vh; position:relative; overflow:hidden; }
    .hero-slide {
      position:absolute; inset:0;
      background-size:cover; background-position:center;
      opacity:0; transition:opacity 1s ease-in-out;
    }
    .hero-slide.active { opacity:1; }
    .hero::after {
      content:""; position:absolute; inset:0;
      background:rgba(0,0,0,0.5);
      z-index:1;
    }
    .hero-content {
      position:absolute; inset:0;
      display:flex; flex-direction:column;
      justify-content:center; align-items:center;
      text-align:center; z-index:2; color:#fff;
    }
    .hero-content h1 { font-size:2.5rem; margin-bottom:10px; }
    .hero-content p { font-size:1.2rem; color:#f5f5f5; }
    .dots { position:absolute; bottom:20px; width:100%; text-align:center; z-index:3; }
    .dots span {
      display:inline-block; width:12px; height:12px; margin:0 4px;
      border-radius:50%; background:#fff; opacity:0.5; cursor:pointer;
    }
    .dots span.active { opacity:1; background:#e50914; }

    /* Search Panel */
    .search-panel {
      max-width:1200px; margin:40px auto; padding:20px;
      display:flex; flex-wrap:wrap; justify-content:center; gap:15px;
      background:#fff; border-radius:12px; box-shadow:0 2px 8px rgba(0,0,0,0.1);
    }
    .search-panel input {
      flex:1 1 calc(33% - 20px);
      padding:10px 14px; border:1px solid #ccc; border-radius:8px; font-size:15px;
    }
    .search-panel button {
      background:#e50914; color:#fff; border:none;
      padding:10px 30px; border-radius:8px;
      font-size:16px; cursor:pointer; transition:0.3s;
    }
    .search-panel button:hover { background:#c20812; }

    /* Responsive: 3 lines on mobile */
    @media (max-width:768px) {
      .search-panel input { flex:1 1 calc(50% - 10px); }
    }
    @media (max-width:480px) {
      .search-panel input { flex:1 1 100%; }
    }

    /* Car Grid */
    .car-grid {
      display:grid; grid-template-columns:repeat(auto-fit,minmax(260px,1fr));
      gap:20px; padding:20px; max-width:1200px; margin:auto;
    }
  </style>
</head>
<body>
  <header>
  <div class="brand">
    <img src="images/Logo/logo.png" alt="Logo" />
    <a href="index.html" class="logo">CLICK<span>WORX</span></a>
  </div>
  <nav>
    <ul>
      <li><a href="index.html">Home</a></li>
      <li><a href="index.html#urgent">Urgent Sale</a></li>
      <li><a href="index.html#morecars">More Cars</a></li>
      <li><a href="search.html">Search</a></li>
      <li><a href="about.html">About Us</a></li>
      <li><a href="contact.html">Contact Us</a></li>
      <li><a href="admin.html" class="admin-link">Admin</a></li>
    </ul>
  </nav>
  <button class="menu-toggle" id="menuToggle">☰</button>
</header>


  <!-- ✅ Hero Slideshow -->
  <section class="hero">
    <div id="heroSlides"></div>
    <div class="hero-content">
      <h1>Search Cars Easily</h1>
      <p>Find the perfect car for your needs</p>
    </div>
    <div class="dots" id="heroDots"></div>
  </section>

  <!-- ✅ Search Panel -->
  <div class="search-panel">
    <input type="text" id="searchName" placeholder="Car Name">
    <input type="text" id="searchModel" placeholder="Model">
    <input type="text" id="searchSpecs" placeholder="Specs">
    <input type="text" id="searchColor" placeholder="Color">
    <input type="text" id="searchLocation" placeholder="Location">
    <input type="text" id="searchPrice" placeholder="Price (≤)">
    <button id="searchBtn">Search</button>
  </div>

  <!-- ✅ Results -->
  <section>
    <div class="car-grid" id="carGrid"></div>
  </section>

  <!-- ✅ Modal Popup (same as more.html / urgent.html) -->
  <div id="carModal" class="modal">
    <div class="modal-content">
      <span class="close">&times;</span>
      <div class="modal-body">
        <div class="modal-images" id="modalImages"></div>
        <div class="modal-details" id="modalDetails"></div>
      </div>
      <div class="buy-section" id="buySection"></div>
    </div>
  </div>

  <script>
  /* ---------- Hero Slideshow ---------- */
  async function loadHeroSlides() {
    let savedBanners = {};
    try {
      const res = await fetch('banners.json');
      if (res.ok) savedBanners = await res.json();
    } catch {
      savedBanners = JSON.parse(localStorage.getItem("banners")) || {};
    }

    const heroContainer = document.getElementById("heroSlides");
    heroContainer.innerHTML = "";
    const heroImages = ["hero1","hero2","hero3","hero4"].map(id => savedBanners[id]).filter(Boolean);
    const fallback = ["images/BG/car02.jpg","images/BG/car03.jpg","images/BG/bg1.jpg","images/BG/bg3.jpg"];
    const slides = heroImages.length ? heroImages : fallback;

    slides.forEach((src,i)=>{
      const div=document.createElement("div");
      div.className="hero-slide";
      div.style.backgroundImage=`url(${src})`;
      if(i===0) div.classList.add("active");
      heroContainer.appendChild(div);
    });

    const dotsContainer=document.getElementById("heroDots");
    dotsContainer.innerHTML="";
    slides.forEach((_,i)=>{
      const dot=document.createElement("span");
      dot.addEventListener("click",()=>showSlide(i));
      dotsContainer.appendChild(dot);
    });
    const dots=dotsContainer.querySelectorAll("span");
    let index=0;
    function showSlide(n){
      const allSlides=document.querySelectorAll(".hero-slide");
      allSlides.forEach(s=>s.classList.remove("active"));
      dots.forEach(d=>d.classList.remove("active"));
      index=(n+allSlides.length)%allSlides.length;
      allSlides[index].classList.add("active");
      dots[index].classList.add("active");
    }
    function nextSlide(){showSlide(index+1);}
    setInterval(nextSlide,5000);
    showSlide(0);
  }

  /* ---------- Load Cars + Search Filter ---------- */
  let allCars = [];

  async function loadCars() {
    try {
      const res = await fetch("cars.json");
      if (!res.ok) throw new Error("cars.json missing");
      allCars = await res.json();
    } catch {
      allCars = JSON.parse(localStorage.getItem("cars")) || [];
    }
    displayCars(allCars);
  }

  function displayCars(cars) {
    const grid = document.getElementById("carGrid");
    grid.innerHTML = "";

    cars.forEach(car => {
      const card = document.createElement("div");
      card.className = "car-card";
      card.innerHTML = `
        <div class="ribbon">${car.ribbon || ""}</div>
        <img src="${car.images?.[0] || 'images/default.jpg'}" alt="${car.name}">
        <h3>${car.name}</h3>
        <p>${car.price ? "Price: " + car.price : ""}</p>
        <button class="btn details-btn">View Details</button>
      `;
      card.querySelector(".details-btn").addEventListener("click", () => openModal(car));
      grid.appendChild(card);
    });
  }

  function searchCars() {
    const name = document.getElementById("searchName").value.toLowerCase();
    const model = document.getElementById("searchModel").value.toLowerCase();
    const specs = document.getElementById("searchSpecs").value.toLowerCase();
    const color = document.getElementById("searchColor").value.toLowerCase();
    const location = document.getElementById("searchLocation").value.toLowerCase();
    const price = parseFloat(document.getElementById("searchPrice").value);

    const filtered = allCars.filter(c => {
      return (
        (!name || c.name.toLowerCase().includes(name)) &&
        (!model || c.model.toLowerCase().includes(model)) &&
        (!specs || c.specs.toLowerCase().includes(specs)) &&
        (!color || c.color.toLowerCase().includes(color)) &&
        (!location || c.location.toLowerCase().includes(location)) &&
        (!price || parseFloat(c.price || 0) <= price)
      );
    });

    displayCars(filtered);
  }

  /* ---------- Modal Popup (same as urgent.html/more.html) ---------- */
  function openModal(car) {
    const modal = document.getElementById("carModal");
    const imgDiv = document.getElementById("modalImages");
    const detailsDiv = document.getElementById("modalDetails");
    const buyDiv = document.getElementById("buySection");

    imgDiv.innerHTML = car.images.map(src => `<img src="${src}" alt="">`).join("");
    detailsDiv.innerHTML = `
      <h2>${car.name}</h2>
      <p><strong>Model:</strong> ${car.model}</p>
      <p><strong>Specs:</strong> ${car.specs}</p>
      <p><strong>Color:</strong> ${car.color}</p>
      <p><strong>Location:</strong> ${car.location}</p>
      <p><strong>Price:</strong> ${car.price}</p>
      <button id="buyBtn" class="btn">I Want To Buy</button>
    `;

    buyDiv.innerHTML = "";
    modal.style.display = "block";

    document.getElementById("buyBtn").onclick = () => {
      const adminData = JSON.parse(localStorage.getItem("adminData")) || {};
      const whatsapp = adminData.whatsapp || "00000000000";
      buyDiv.innerHTML = `
        <h3>I Want To Buy This</h3>
        <form id="whatsappForm">
          <input type="text" id="buyerName" placeholder="Your Name" required>
          <input type="text" id="buyerContact" placeholder="Contact No" required>
          <textarea id="buyerMsg" placeholder="Message"></textarea>
          <button type="submit" class="btn">Send on WhatsApp</button>
        </form>
      `;
      document.getElementById("whatsappForm").onsubmit = (e) => {
        e.preventDefault();
        const name = document.getElementById("buyerName").value;
        const contact = document.getElementById("buyerContact").value;
        const msg = document.getElementById("buyerMsg").value;
        const text = `*Car Inquiry*\nCar: ${car.name}\nName: ${name}\nContact: ${contact}\nMessage: ${msg}`;
        window.open(`https://wa.me/${whatsapp}?text=${encodeURIComponent(text)}`, "_blank");
      };
    };

    document.querySelector(".close").onclick = () => (modal.style.display = "none");
    window.onclick = (e) => { if (e.target === modal) modal.style.display = "none"; };
  }

  /* ---------- Init ---------- */
  window.onload = () => {
    loadHeroSlides();
    loadCars();
    document.getElementById("searchBtn").addEventListener("click", searchCars);
  };
  
document.addEventListener("DOMContentLoaded", () => {
  const menuToggle = document.getElementById("menuToggle");
  const navList = document.querySelector("nav ul");

  if (menuToggle && navList) {
    // ✅ Toggle menu open/close
    menuToggle.addEventListener("click", (e) => {
      e.stopPropagation();
      navList.classList.toggle("active");
    });

    // ✅ Close menu when clicking anywhere outside it
    document.addEventListener("click", (event) => {
      if (!navList.contains(event.target) && !menuToggle.contains(event.target)) {
        navList.classList.remove("active");
      }
    });

    // ✅ Close menu when a link is clicked (auto-hide on page change)
    navList.querySelectorAll("a").forEach(link => {
      link.addEventListener("click", () => {
        navList.classList.remove("active");
      });
    });

    // ✅ Always hide menu on page load (if it was open before)
    window.addEventListener("pageshow", () => {
      navList.classList.remove("active");
    });
  }
});

  </script>
</body>
</html>
