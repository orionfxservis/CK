<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Click Worx - Cars</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    body { margin:0; font-family:Arial,sans-serif; background:#000; color:#fff; }
    header { position:fixed; top:0; left:0; right:0; z-index:60; display:flex; justify-content:space-between; border-bottom:2px solid #e50914; background:#111; padding:10px 20px; }
    header h1 { margin:0; font-size:20px; color:#e50914; }
    header nav a { color:#fff; text-decoration:none; margin-left:15px; }
    .content { margin-top:70px; padding:20px; }

    .main-layout { display:flex; justify-content:space-between; gap:20px; }
    .side-box { flex:1; max-width:140px; height:auto; }
    .side-box img { width:100%; height:auto; object-fit:cover; border-radius:6px; }

    .search-section { flex:2; width:100%; max-width:800px; }
    .search-bar { display:grid; grid-template-columns:1fr 1fr; gap:10px; margin-bottom:20px; }
    .search-bar input, .search-bar select, .search-bar textarea { padding:10px; border:none; border-radius:4px; width:100%; }
    .search-btn { grid-column:span 2; padding:10px; background:#e50914; border:none; color:#fff; cursor:pointer; font-weight:bold; }

    .banner-horizontal { text-align:center; margin:20px 0; }
    .banner-horizontal img { max-width:100%; height:auto; border-radius:6px; }

    .cars-grid { display:grid; grid-template-columns:repeat(auto-fit,minmax(220px,1fr)); gap:20px; }
    .car-card { background:#111; border:1px solid #333; border-radius:8px; padding:10px; position:relative; }
    .car-card img { width:100%; height:140px; object-fit:cover; border-radius:4px; }
    .car-info { padding:8px 0; }
    .car-info h3 { margin:0; font-size:16px; }
    .car-info p { margin:4px 0; font-size:14px; }
    .car-ribbon { position:absolute; top:10px; left:-10px; background:#e50914; color:#fff; padding:4px 8px; font-size:12px; font-weight:bold; transform:rotate(-15deg); }

    /* Modal */
    .modal { display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.9); z-index:200; justify-content:center; align-items:center; }
    .modal-content { background:#111; padding:20px; border-radius:8px; max-width:90%; width:800px; position:relative; color:#fff; }
    .modal-close { position:absolute; top:10px; right:10px; font-size:24px; cursor:pointer; }
    .modal-body { display:flex; gap:20px; flex-wrap:wrap; }
    .modal-images { flex:1; text-align:center; }
    .modal-images img { max-width:100%; border-radius:6px; display:none; }
    .modal-images img.active { display:block; }
    .modal-thumbs { display:flex; gap:6px; margin-top:10px; justify-content:center; flex-wrap:wrap; }
    .modal-thumbs img { width:60px; height:40px; object-fit:cover; cursor:pointer; border-radius:4px; }
    .modal-details { flex:1; min-width:200px; }
    .modal-details h2 { margin:0 0 10px; }
    .modal-details p { margin:5px 0; }

    /* ---------- Responsive fixes ---------- */
    @media (max-width: 900px) {
      .main-layout { flex-direction:column; align-items:center; }
      .side-box { width:100%; max-width:100%; margin:10px 0; height:auto; }
      .search-section { width:100%; margin:0; }
    }
    @media (max-width: 600px) {
      .search-bar { grid-template-columns:1fr; }
      .search-bar textarea, .search-btn { grid-column:span 1; }
      .banner-horizontal img { max-width:100%; height:auto; }
      .modal-body { flex-direction:column; }
      .modal-images img.active { height:auto; max-height:220px; }
    }
  </style>
</head>
<body>
  <header>
    <h1>Click Worx</h1>
    <nav>
      <a href="index.html">Home</a>
      <a href="about.html">About</a>
      <a href="contact.html">Contact</a>
      <a href="admin.html">Admin</a>
    </nav>
  </header>

  <div class="content">
    <div class="main-layout">
      <div class="side-box"><img id="leftBanner" alt="Left Banner"></div>
      <div class="search-section">
        <div class="search-bar">
          <input type="text" id="searchInput" placeholder="Search by name...">
          <select id="filterModel"><option value="">All Models</option></select>
          <textarea id="searchNotes" placeholder="Extra notes..."></textarea>
          <button class="search-btn" onclick="applyFilters()">Search</button>
        </div>
        <div class="banner-horizontal"><img id="horizontalBanner" alt="Horizontal Banner"></div>
        <div class="cars-grid" id="carsGrid"></div>
      </div>
      <div class="side-box"><img id="rightBanner" alt="Right Banner"></div>
    </div>
  </div>

  <!-- Modal -->
  <div class="modal" id="carModal">
    <div class="modal-content">
      <span class="modal-close" onclick="closeModal()">&times;</span>
      <div class="modal-body">
        <div class="modal-images">
          <img id="modalMainImg" class="active" src="">
          <div class="modal-thumbs" id="modalThumbs"></div>
        </div>
        <div class="modal-details" id="modalDetails"></div>
      </div>
    </div>
  </div>

  <script>
    // Load banners
    window.addEventListener('DOMContentLoaded', () => {
      const l = localStorage.getItem('leftBanner');
      const r = localStorage.getItem('rightBanner');
      const h = localStorage.getItem('horizontalBanner');
      document.getElementById('leftBanner').src = l || 'images/Cars/left_banner.jpg';
      document.getElementById('rightBanner').src = r || 'images/Cars/right_banner.jpg';
      document.getElementById('horizontalBanner').src = h || 'images/Cars/horizontal_banner.jpg';

      loadCars();
    });

    // Fallback demo cars
    const fallbackCars = [
      {
        name: "Honda Civic",
        price: "45000",
        images: ["images/sample/car1.jpg"],
        model: "2020",
        specs: "Full Option",
        color: "White",
        mileage: "32,000 km",
        location: "Dubai",
        ribbon: "Hot Deal",
        features: "Well maintained, single owner, accident free."
      },
      {
        name: "Toyota Corolla",
        price: "38000",
        images: ["images/sample/car2.jpg"],
        model: "2019",
        specs: "GCC",
        color: "Black",
        mileage: "40,000 km",
        location: "Sharjah",
        ribbon: "Urgent",
        features: "Excellent condition, service history available."
      },
      {
        name: "Nissan Altima",
        price: "42000",
        images: ["images/sample/car3.jpg"],
        model: "2021",
        specs: "Full Option",
        color: "Silver",
        mileage: "25,000 km",
        location: "Abu Dhabi",
        ribbon: "Featured",
        features: "Low mileage, warranty available."
      }
    ];

    // Load cars
    function loadCars() {
      let cars = JSON.parse(localStorage.getItem('cars')) || fallbackCars;
      populateModelDropdown(cars);
      renderCars(cars);
    }

    function renderCars(cars) {
      const grid = document.getElementById('carsGrid');
      grid.innerHTML = '';

      cars.forEach((car, index) => {
        const card = document.createElement('div');
        card.className = 'car-card';
        card.innerHTML = `
          ${car.ribbon ? `<div class="car-ribbon">${car.ribbon}</div>` : ''}
          <img src="${car.images[0]}" alt="${car.name}">
          <div class="car-info">
            <h3>${car.name}</h3>
            <p>${car.model} - ${car.color}</p>
            <p>AED ${car.price}</p>
            <button onclick="openModal(${index})">Details</button>
          </div>
        `;
        grid.appendChild(card);
      });
    }

    // Open modal
    function openModal(index) {
      const cars = JSON.parse(localStorage.getItem('cars')) || fallbackCars;
      const car = cars[index];
      document.getElementById('modalMainImg').src = car.images[0];
      const thumbs = document.getElementById('modalThumbs');
      thumbs.innerHTML = '';
      car.images.forEach((img) => {
        const t = document.createElement('img');
        t.src = img;
        t.onclick = () => {
          document.getElementById('modalMainImg').src = img;
        };
        thumbs.appendChild(t);
      });

      const details = document.getElementById('modalDetails');
      details.innerHTML = `
        <h2>${car.name}</h2>
        <p><strong>Model:</strong> ${car.model}</p>
        <p><strong>Color:</strong> ${car.color}</p>
        <p><strong>Mileage:</strong> ${car.mileage}</p>
        <p><strong>Location:</strong> ${car.location}</p>
        <p><strong>Specs:</strong> ${car.specs}</p>
        <p><strong>Features:</strong> ${car.features}</p>
        <p><strong>Price:</strong> AED ${car.price}</p>
      `;

      document.getElementById('carModal').style.display = 'flex';
    }

    function closeModal() {
      document.getElementById('carModal').style.display = 'none';
    }

    // Populate models in dropdown
    function populateModelDropdown(cars) {
      const models = [...new Set(cars.map(c => c.model))];
      const dropdown = document.getElementById('filterModel');
      dropdown.innerHTML = '<option value="">All Models</option>';
      models.forEach(m => {
        const opt = document.createElement('option');
        opt.value = m;
        opt.textContent = m;
        dropdown.appendChild(opt);
      });
    }

    // Filters
    function applyFilters() {
      const searchValue = document.getElementById('searchInput').value.toLowerCase();
      const filterModel = document.getElementById('filterModel').value;
      let cars = JSON.parse(localStorage.getItem('cars')) || fallbackCars;

      let filtered = cars.filter(c => 
        (!searchValue || c.name.toLowerCase().includes(searchValue)) &&
        (!filterModel || c.model === filterModel)
      );

      renderCars(filtered);
    }
  </script>
</body>
</html>
