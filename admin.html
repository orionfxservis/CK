<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Admin Panel - Click Worx</title>
<style>
body { margin:0; font-family:Arial,sans-serif; background:#000; color:#fff; }
header{ position:fixed; top:0; left:0; right:0; z-index:60; display:flex; justify-content:space-between; border-bottom: 2px solid #e50914; border-radius: 0 0 12px 12px; align-items:center; padding:12px 18px; background:rgba(0,0,0,0.78); backdrop-filter:blur(6px);}
header h1{ margin:0; font-size:20px; color:#e50914; }
nav a{ color:#fff; text-decoration:none; margin-left:12px; font-weight:600; font-size:14px; }
nav a.admin{ background:var(--red); padding:6px 10px; border-radius:6px; }
.page-top{ height:64px; } 
.slideshow { position:fixed; top:0; left:0; width:100%; height:100%; z-index:-1; }
.slideshow img { position:absolute; width:100%; height:100%; object-fit:cover; opacity:0; transition:opacity 1s; filter:blur(6px) brightness(0.4); }
.slideshow img.active { opacity:1; }
.content { position:relative; z-index:5; padding:40px; overflow:visible !important; }
form { max-width:400px; background:rgba(30,30,30,0.9); padding:20px; border: 1px solid #e50914; border-radius:10px; margin-bottom:40px; }
form input,form textarea,form select { width:100%; margin-bottom:10px; padding:8px; border:none; border-radius:5px; }
form label { font-size:14px; display:block; margin-bottom:3px; }
.negotiable-row { display:flex; align-items:center; justify-content:space-between; margin:10px 0; }
form button { background:#e60000; color:#fff; padding:10px; border:none; border-radius:5px; cursor:pointer; }
form button:hover { background:#c00000; }

table { 
  width:100%; 
  border-collapse:collapse; 
  background:rgba(30,30,30,0.9); 
  margin-bottom:10px; 
  table-layout:auto;
}
th,td { 
  padding:10px; 
  border:1px solid #e50914;
  font-size:14px; 
  vertical-align:top; 
  white-space:normal;  
}
img.thumb { width:60px; height:40px; object-fit:cover; border-radius:4px; cursor:pointer; margin-right:3px; }
h2,h3 { color:#e60000; }
#lightboxOverlay { display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.9); z-index:9999; justify-content:center; align-items:center; }
#lightboxOverlay img { max-width:90%; max-height:90%; border-radius:8px; box-shadow:0 0 20px #000; }
#lightboxOverlay span { position:absolute; top:20px; right:30px; font-size:32px; color:#fff; cursor:pointer; }

/* ✅ Banner Box Styles */
.banner-box {
  position: absolute;
  top: 100px;
  right: 40px;
  width: 260px;
  background: rgba(20,20,20,0.9);
  border: 1px solid #e50914;
  border-radius: 10px;
  padding: 15px;
  box-shadow: 0 4px 12px rgba(0,0,0,0.5);
}
.banner-box h3 {
  margin: 0 0 12px;
  font-size: 16px;
  color: #e50914;
  text-align:center;
}
.banner-box label {
  display:block;
  font-size:13px;
  margin:8px 0 4px;
}
.banner-box input[type="file"] {
  display:block;
  margin-bottom:8px;
  font-size:12px;
  color:#ccc;
}
.banner-preview {
  width:100%;
  height:80px;
  border-radius:6px;
  object-fit:cover;
  margin-bottom:10px;
  border:1px solid #333;
}
.banner-box button {
  width:100%;
  background:#e50914;
  color:#fff;
  border:0;
  padding:8px;
  border-radius:6px;
  cursor:pointer;
  font-weight:600;
}
.banner-box button:hover {
  background:#c00000;
}
</style>
</head>
<body>
<header>
<h1>Click Worx</h1>
<nav>
<a href="index.html">Home</a>
<a href="about.html">About</a>
<a href="contact.html">Contact</a>
<a href="admin.html" class="admin-btn">Admin</a>
</nav>
</header>

<div class="slideshow" id="slideshow">
<img src="images/BG/01.jpg" class="active">
<img src="images/BG/02.jpg">
<img src="images/BG/03.jpg">
<img src="images/BG/04.jpg">
</div>

<div class="content">
<h2>Admin Panel</h2>

<!-- ✅ Banner Box (top-right) -->
<div class="banner-box">
  <h3>Manage Banners</h3>
  <label>Left Banner</label>
  <input type="file" accept="image/*" onchange="uploadBanner(event,'leftBanner','leftPreview')">
  <img id="leftPreview" class="banner-preview" src="" alt="Left Banner">

  <label>Right Banner</label>
  <input type="file" accept="image/*" onchange="uploadBanner(event,'rightBanner','rightPreview')">
  <img id="rightPreview" class="banner-preview" src="" alt="Right Banner">

  <label>Horizontal Banner</label>
  <input type="file" accept="image/*" onchange="uploadBanner(event,'horizontalBanner','horizPreview')">
  <img id="horizPreview" class="banner-preview" src="" alt="Horizontal Banner">

  <button onclick="resetBanners()">Reset Banners</button>
</div>

<!-- Car form -->
<form id="carForm">
<input type="hidden" id="editIndex" value="">
<label>Category</label>
<select id="carCategory" required>
<option value="urgent">Post on Urgent Sale</option>
<option value="more">Post on More Cars</option>
</select>
<label>Car Name</label>
<input type="text" id="carName" required>
<label>Model</label>
<input type="text" id="carModel">
<label>Specs</label>
<input type="text" id="carSpecs">
<label>Color</label>
<input type="text" id="carColor">
<label>Mileage</label>
<input type="text" id="carMileage">
<label>Milkiya</label>
<input type="text" id="carMilkiya">
<label>Accident History</label>
<input type="text" id="carAccident">
<label>Location</label>
<input type="text" id="carLocation">
<label>Price (AED)</label>
<input type="number" id="carPrice" required>
<div class="negotiable-row">
<label for="carNegotiable">Negotiable</label>
<input type="checkbox" id="carNegotiable">
</div>
<label>Complete Details</label>
<textarea id="carFeatures"></textarea>
<label>Ribbon</label>
<select id="carRibbon">
<option value="">None</option>
<option value="Urgent Sale">Urgent Sale</option>
<option value="Special Discount">Special Discount</option>
<option value="Low Budget">Low Budget</option>
</select>
<label>Enter Image Filenames (comma separated, from /images/ folder)</label>
<input type="text" id="carImages" placeholder="e.g. car1.jpg, car2.jpg">
<button type="submit">Save Car</button>
</form>

<h3>Urgent Sale Cars</h3>
<table id="urgentTable">
<thead><tr><th>Thumbnails</th><th>Name</th><th>Price</th><th>Negotiable</th><th>Ribbon</th><th>Actions</th></tr></thead>
<tbody></tbody>
</table>

<h3>More Cars</h3>
<table id="moreTable">
<thead><tr><th>Thumbnails</th><th>Name</th><th>Price</th><th>Negotiable</th><th>Ribbon</th><th>Actions</th></tr></thead>
<tbody></tbody>
</table>
</div>

<div id="lightboxOverlay">
<span onclick="closeLightbox()">&times;</span>
<img id="lightboxImg" src="">
</div>

<script>
// slideshow
const slides=document.querySelectorAll('.slideshow img');
let curSlide=0;
setInterval(()=>{ slides[curSlide].classList.remove('active'); curSlide=(curSlide+1)%slides.length; slides[curSlide].classList.add('active'); },4000);

// cars
let cars = JSON.parse(localStorage.getItem("cars") || "[]");
const carForm = document.getElementById("carForm");

carForm.addEventListener("submit", e=>{
  e.preventDefault();
  let editIndex = document.getElementById("editIndex").value;
  editIndex = editIndex === "" ? null : parseInt(editIndex);

  let imgInput = document.getElementById("carImages").value.trim();
  let imgFiles = imgInput ? imgInput.split(",").map(f=>"images/"+f.trim()) : [];

  let car = {
    category: document.getElementById("carCategory").value,
    name: document.getElementById("carName").value,
    model: document.getElementById("carModel").value,
    specs: document.getElementById("carSpecs").value,
    color: document.getElementById("carColor").value,
    mileage: document.getElementById("carMileage").value,
    milkiya: document.getElementById("carMilkiya").value,
    accident: document.getElementById("carAccident").value,
    location: document.getElementById("carLocation").value,
    price: document.getElementById("carPrice").value,
    negotiable: document.getElementById("carNegotiable").checked,
    features: document.getElementById("carFeatures").value,
    ribbon: document.getElementById("carRibbon").value,
    images: imgFiles
  };

  if(editIndex === null){
    cars.push(car);
    alert("Car added!");
  } else {
    cars[editIndex] = car;
    alert("Car updated!");
  }

  localStorage.setItem("cars", JSON.stringify(cars));

  carForm.reset();
  document.getElementById("editIndex").value = "";
  renderTables();
});

function renderTables(){
  const urgentTable = document.querySelector("#urgentTable tbody");
  const moreTable = document.querySelector("#moreTable tbody");
  urgentTable.innerHTML = "";
  moreTable.innerHTML = "";

  const urgentCars = cars.filter(c=>c.category==="urgent");
  const moreCars = cars.filter(c=>c.category==="more");

  urgentCars.forEach((car) => addRow(car, urgentTable));
  moreCars.forEach((car) => addRow(car, moreTable));
}

function addRow(car, table){
  const row = document.createElement("tr");
  let thumbnails = "";
  if (car.images && car.images.length > 0) {
    thumbnails = car.images.map((img) => 
      `<img src="${img}" class="thumb" onclick="openLightbox('${img}')">`
    ).join(" ");
  }
  row.innerHTML = `
    <td>${thumbnails}</td>
    <td>${car.name}</td>
    <td>AED ${car.price}</td>
    <td>${car.negotiable ? 'Yes' : 'No'}</td>
    <td>${car.ribbon || ''}</td>
    <td>
      <button onclick="editCar(${cars.indexOf(car)})">Edit</button>
      <button onclick="deleteCar(${cars.indexOf(car)})">Delete</button>
    </td>`;
  table.appendChild(row);
}

function editCar(i){
  const car = cars[i];
  document.getElementById("editIndex").value = i;
  document.getElementById("carCategory").value = car.category;
  document.getElementById("carName").value = car.name;
  document.getElementById("carModel").value = car.model;
  document.getElementById("carSpecs").value = car.specs;
  document.getElementById("carColor").value = car.color;
  document.getElementById("carMileage").value = car.mileage;
  document.getElementById("carMilkiya").value = car.milkiya;
  document.getElementById("carAccident").value = car.accident;
  document.getElementById("carLocation").value = car.location;
  document.getElementById("carPrice").value = car.price;
  document.getElementById("carNegotiable").checked = car.negotiable;
  document.getElementById("carFeatures").value = car.features;
  document.getElementById("carRibbon").value = car.ribbon;
  document.getElementById("carImages").value = (car.images||[]).map(p=>p.replace("images/","")).join(", ");
}

function deleteCar(i){ 
  if(confirm("Delete this car?")){ 
    cars.splice(i,1); 
    localStorage.setItem("cars",JSON.stringify(cars)); 
    renderTables(); 
  } 
}

function openLightbox(src){ document.getElementById("lightboxImg").src=src; document.getElementById("lightboxOverlay").style.display="flex"; }
function closeLightbox(){ document.getElementById("lightboxOverlay").style.display="none"; }

/* ✅ Banner Functions */
window.addEventListener('DOMContentLoaded',()=>{
  const left = localStorage.getItem('leftBanner');
  const right = localStorage.getItem('rightBanner');
  const horiz = localStorage.getItem('horizontalBanner');
  if(left) document.getElementById('leftPreview').src = left;
  if(right) document.getElementById('rightPreview').src = right;
  if(horiz) document.getElementById('horizPreview').src = horiz;
});

function uploadBanner(e,key,previewId){
  const file = e.target.files[0];
  if(!file) return;
  const reader = new FileReader();
  reader.onload = function(ev){
    localStorage.setItem(key, ev.target.result);
    document.getElementById(previewId).src = ev.target.result;
    alert(key+" updated!");
  };
  reader.readAsDataURL(file);
}

function resetBanners(){
  if(confirm("Reset all banners?")){
    localStorage.removeItem('leftBanner');
    localStorage.removeItem('rightBanner');
    localStorage.removeItem('horizontalBanner');
    document.getElementById('leftPreview').src = "";
    document.getElementById('rightPreview').src = "";
    document.getElementById('horizPreview').src = "";
    alert("Banners reset.");
  }
}

renderTables();
</script>
</body>
</html>
