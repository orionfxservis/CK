<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Admin Panel - ClickWorx</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    :root {
      --red: #e50914;
      --red-dark: #b00610;
      --bg-dark: #0d0d0d;
      --bg-card: #1a1a1a;
      --text-light: #fff;
    }
    body {
      font-family: Arial, sans-serif;
      background: var(--bg-dark);
      color: var(--text-light);
      padding: 15px;
    }
    h1 { text-align: center; color: var(--red); margin-bottom: 20px; }
    .flex-row { display: flex; gap: 15px; flex-wrap: wrap; }
    .section {
      background: var(--bg-card);
      padding: 15px;
      border-radius: 8px;
      border: 1px solid var(--red);
      flex: 1;
      min-width: 320px;
      margin-bottom: 15px;
    }
    h2 { margin: 0 0 10px; color: var(--red); font-size: 18px; }
    label { display: block; margin-top: 8px; font-size: 14px; }
    input, select, textarea {
      width: 100%; margin-top: 5px; padding: 6px;
      border-radius: 6px; border: none; outline: none;
    }
    textarea { min-height: 70px; resize: vertical; }
    .inline { display: flex; align-items: center; gap: 10px; margin-top: 8px; }
    button {
      margin-top: 10px; padding: 6px 12px;
      background: var(--red); border: none; border-radius: 6px;
      color: #fff; cursor: pointer; font-size: 14px;
    }
    button:hover { background: var(--red-dark); }
    .preview { margin-top: 8px; max-width: 100%; border-radius: 6px; }
    table { width: 100%; border-collapse: collapse; margin-top: 15px; font-size: 14px; }
    th, td { padding: 6px; border: 1px solid #333; text-align: left; }
    th { background: #222; }
    td img { max-width: 80px; border-radius: 4px; }
    tr.dragging { opacity: 0.5; background: #333; }
    .export-buttons { margin-top: 10px; display: flex; gap: 10px; flex-wrap: wrap; }
    /* Login Overlay */
    #loginOverlay {
      position: fixed; inset: 0; background: rgba(0,0,0,0.9);
      display: flex; align-items: center; justify-content: center;
      z-index: 9999;
    }
    #loginBox {
      background: var(--bg-card);
      padding: 20px;
      border-radius: 10px;
      border: 1px solid var(--red);
      width: 300px;
      text-align: center;
    }
    #loginBox h2 { margin-bottom: 15px; }
  </style>
</head>
<body>

  <div id="loginOverlay">
    <div id="loginBox">
      <h2>Admin Login</h2>
      <input type="password" id="loginPassword" placeholder="Enter Password">
      <button onclick="checkLogin()">Login</button>
      <hr style="margin:15px 0;border:0;border-top:1px solid #333;">
      <h3 style="color:var(--red);font-size:16px;">Set New Password</h3>
      <input type="password" id="newPassword" placeholder="New Password">
      <button onclick="setPassword()">Save Password</button>
    </div>
  </div>

  <h1>Admin Panel</h1>

  <div class="flex-row">
    <!-- Car Management -->
    <div class="section">
      <h2>Add / Manage Cars</h2>
      <label>Category</label>
      <select id="carCategory">
        <option value="urgent">Urgent Sale</option>
        <option value="normal">Normal</option>
      </select>
      <label>Car Name</label><input type="text" id="carName">
      <label>Model</label><input type="text" id="carModel">
      <label>Specs</label><input type="text" id="carSpecs">
      <label>Color</label><input type="text" id="carColor">
      <label>Mileage</label><input type="text" id="carMileage">
      <label>Milkiya</label><input type="text" id="carMilkiya">
      <label>Accident History</label><input type="text" id="carAccident">
      <label>Price</label>
      <div class="inline">
        <input type="text" id="carPrice" placeholder="e.g. $25,000">
        <label><input type="checkbox" id="carNegotiable"> Negotiable</label>
      </div>
      <label>Ribbon</label>
      <input type="text" id="carRibbon" placeholder="e.g. Hot Deal, Limited">
      <label>Details</label>
      <textarea id="carDetails"></textarea>
      <label>Upload Car Images (Multiple)</label>
      <input type="file" id="carImages" accept="image/*" multiple>
      <div id="carImagePreview"></div>
      <button onclick="addCar()">Add Car</button>
    </div>

    <!-- Banner Management -->
    <div class="section">
      <h2>Manage Banners</h2>
      <label>Left Banner</label>
      <input type="file" id="leftBanner" accept="image/*">
      <img id="leftPreview" class="preview" style="display:none;" />
      <label>Right Banner</label>
      <input type="file" id="rightBanner" accept="image/*">
      <img id="rightPreview" class="preview" style="display:none;" />
      <label>Horizontal Banner</label>
      <input type="file" id="horizontalBanner" accept="image/*">
      <img id="horizontalPreview" class="preview" style="display:none;" />
      <button onclick="saveBanners()">Save Banners</button>
      <table id="bannerTable">
        <thead>
          <tr><th>Type</th><th>Preview</th><th>Actions</th></tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>

    <!-- Hero Images -->
    <div class="section">
      <h2>Hero Slideshow</h2>
      <label>Hero Image 1</label><input type="file" id="hero1" accept="image/*">
      <label>Hero Image 2</label><input type="file" id="hero2" accept="image/*">
      <label>Hero Image 3</label><input type="file" id="hero3" accept="image/*">
      <label>Hero Image 4</label><input type="file" id="hero4" accept="image/*">
      <button onclick="saveHero()">Save Hero Images</button>
      <table id="heroTable">
        <thead><tr><th>Image</th><th>Preview</th></tr></thead>
        <tbody></tbody>
      </table>
    </div>

    <!-- WhatsApp -->
    <div class="section">
      <h2>WhatsApp Settings</h2>
      <label>WhatsApp Number</label>
      <input type="text" id="whatsappNumber" placeholder="923001234567">
      <button onclick="saveWhatsApp()">Save Number</button>
    </div>

    <!-- Export -->
    <div class="section">
      <h2>Export Data</h2>
      <div class="export-buttons">
        <button onclick="exportCars()">Export cars.json</button>
        <button onclick="exportBanners()">Export banners.json</button>
      </div>
    </div>
  </div>

  <!-- Cars List -->
  <div class="section">
    <h2>Cars List (Drag to Reorder)</h2>
    <table id="carTable">
      <thead>
        <tr>
          <th>Image</th><th>Name</th><th>Model</th><th>Specs</th><th>Price</th><th>Actions</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>

<script>
let cars = JSON.parse(localStorage.getItem("cars")) || [];
let banners = JSON.parse(localStorage.getItem("banners")) || {};
let storedPassword = localStorage.getItem("adminPassword") || "admin123";

function checkLogin() {
  const pass = document.getElementById("loginPassword").value;
  if (pass === storedPassword) {
    document.getElementById("loginOverlay").style.display = "none";
  } else {
    alert("Wrong password!");
  }
}
function setPassword() {
  const newPass = document.getElementById("newPassword").value;
  if (newPass.trim() !== "") {
    localStorage.setItem("adminPassword", newPass);
    storedPassword = newPass;
    alert("Password updated!");
  } else {
    alert("Password cannot be empty.");
  }
}

/* ---- Car functions ---- */
function addCar() {
  const car = {
    category: document.getElementById("carCategory").value,
    name: document.getElementById("carName").value,
    model: document.getElementById("carModel").value,
    specs: document.getElementById("carSpecs").value,
    color: document.getElementById("carColor").value,
    mileage: document.getElementById("carMileage").value,
    milkiya: document.getElementById("carMilkiya").value,
    accident: document.getElementById("carAccident").value,
    price: document.getElementById("carPrice").value,
    negotiable: document.getElementById("carNegotiable").checked,
    ribbon: document.getElementById("carRibbon").value,
    details: document.getElementById("carDetails").value,
    images: []
  };
  const files = document.getElementById("carImages").files;
  for (let f of files) {
    car.images.push(URL.createObjectURL(f));
  }
  cars.unshift(car);
  localStorage.setItem("cars", JSON.stringify(cars));
  renderCarTable();
}
function renderCarTable() {
  const tbody = document.querySelector("#carTable tbody");
  tbody.innerHTML = "";
  cars.forEach((c,i)=>{
    const tr = document.createElement("tr");
    tr.innerHTML = `
      <td>${c.images[0] ? `<img src="${c.images[0]}">` : ""}</td>
      <td>${c.name}</td>
      <td>${c.model}</td>
      <td>${c.specs}</td>
      <td>${c.price}</td>
      <td><button onclick="deleteCar(${i})">Delete</button></td>
    `;
    tbody.appendChild(tr);
  });
}
function deleteCar(i) {
  cars.splice(i,1);
  localStorage.setItem("cars", JSON.stringify(cars));
  renderCarTable();
}

/* ---- Banner functions ---- */
function saveBanners() {
  ["left","right","horizontal"].forEach(type=>{
    const file = document.getElementById(type+"Banner").files[0];
    if (file) {
      banners[type] = URL.createObjectURL(file);
    }
  });
  localStorage.setItem("banners", JSON.stringify(banners));
  renderBannerTable();
}
function renderBannerTable() {
  const tbody = document.querySelector("#bannerTable tbody");
  tbody.innerHTML = "";
  ["left","right","horizontal"].forEach(type=>{
    if (banners[type]) {
      const tr = document.createElement("tr");
      tr.innerHTML = `<td>${type}</td><td><img src="${banners[type]}"></td>
      <td><button onclick="removeBanner('${type}')">Delete</button></td>`;
      tbody.appendChild(tr);
    }
  });
}
function removeBanner(type) {
  delete banners[type];
  localStorage.setItem("banners", JSON.stringify(banners));
  renderBannerTable();
}

/* ---- Hero functions ---- */
function saveHero() {
  ["hero1","hero2","hero3","hero4"].forEach((id,i)=>{
    const file = document.getElementById(id).files[0];
    if (file) {
      banners["hero"+(i+1)] = URL.createObjectURL(file);
    }
  });
  localStorage.setItem("banners", JSON.stringify(banners));
  renderHeroTable();
}
function renderHeroTable() {
  const tbody = document.querySelector("#heroTable tbody");
  tbody.innerHTML = "";
  ["hero1","hero2","hero3","hero4"].forEach(key=>{
    if (banners[key]) {
      const tr = document.createElement("tr");
      tr.innerHTML = `<td>${key}</td><td><img src="${banners[key]}" style="max-width:120px;"></td>`;
      tbody.appendChild(tr);
    }
  });
}

/* ---- WhatsApp ---- */
function saveWhatsApp() {
  banners.whatsapp = document.getElementById("whatsappNumber").value;
  localStorage.setItem("banners", JSON.stringify(banners));
  alert("Saved!");
}

/* ---- Export ---- */
function exportCars() {
  const blob = new Blob([JSON.stringify(cars,null,2)], {type:"application/json"});
  const a = document.createElement("a");
  a.href = URL.createObjectURL(blob);
  a.download = "cars.json";
  a.click();
}
function exportBanners() {
  const blob = new Blob([JSON.stringify(banners,null,2)], {type:"application/json"});
  const a = document.createElement("a");
  a.href = URL.createObjectURL(blob);
  a.download = "banners.json";
  a.click();
}

window.onload = function() {
  renderCarTable();
  renderBannerTable();
  renderHeroTable();
  document.getElementById("whatsappNumber").value = banners.whatsapp || "";
};
</script>

</body>
</html>
