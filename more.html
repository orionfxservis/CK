<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>More Cars - ClickWorx</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="style.css">
<style>
/* Hero */
.hero { margin-top:70px; height:70vh; position:relative; overflow:hidden; z-index:1; }
.hero-slide { position:absolute; inset:0; background-size:cover; background-position:center; opacity:0; transition:opacity 1s ease-in-out; }
.hero-slide.active { opacity:1; }
.hero::after { content:""; position:absolute; inset:0; background:rgba(0,0,0,0.4); z-index:1; }
.hero-content { position:absolute; inset:0; display:flex; flex-direction:column; justify-content:center; align-items:center; text-align:center; z-index:2; color:#fff; }
.hero-content h1 { font-size:2.5rem; margin-bottom:10px; }
.hero-content p { font-size:1.2rem; color:#f1f1f1; }
.dots { position:absolute; bottom:20px; width:100%; text-align:center; z-index:3; }
.dots span { display:inline-block; width:12px; height:12px; margin:0 4px; border-radius:50%; background:#fff; opacity:0.5; cursor:pointer; }
.dots span.active { opacity:1; background:#e50914; }

/* Cars Table Overlay */
.content-wrapper {
  position:relative; z-index:2; max-width:1200px; margin:-120px auto 40px; padding:20px;
  background:rgba(17,17,17,0.85); border-radius:12px; backdrop-filter:blur(6px);
}
.content-wrapper h2 { text-align:center; margin-bottom:20px; color:#fff; }
.car-table { width:100%; border-collapse:collapse; border-radius:12px; overflow:hidden; }
.car-table th, .car-table td { padding:12px; text-align:center; border-bottom:1px solid #333; color:#fff; }
.car-table th { background:#111; }
.car-image { width:100px; height:40px; object-fit:cover; border-radius:6px; }

/* Buttons */
.btn { padding:8px 16px; border:none; border-radius:6px; background:#e50914; color:#fff; font-weight:600; cursor:pointer; transition:0.3s; }
.btn:hover { background:#c40812; }

/* Modal (same as index.html) */
.modal { display:none; position:fixed; inset:0; background:rgba(0,0,0,0.8); z-index:2000; justify-content:center; align-items:center; }
.modal-content { background:#1a1a1a; border:1px solid #e50914; padding:20px; border-radius:10px; max-width:900px; width:90%; max-height:90vh; display:flex; gap:20px; overflow:hidden; }
.modal-left { flex:1; overflow-y:auto; }
.modal-left img { width:100%; margin-bottom:10px; border-radius:6px; }
.modal-right { flex:1; overflow-y:auto; }
.modal-close { position:absolute; top:20px; right:20px; font-size:30px; color:#fff; cursor:pointer; }
.buy-form { margin-top:15px; display:none; flex-direction:column; gap:10px; }
.buy-form input, .buy-form textarea { width:95%; padding:10px; border:none; border-radius:5px; }
@media(max-width:768px){ .modal-content{ flex-direction:column; } .modal-left{ display:flex; flex-direction:row; overflow-x:auto; gap:10px; } .modal-left img{ width:80%; flex-shrink:0; } }
</style>
</head>
<body>
<header>
<div class="brand"><img src="images/Logo/logo.png" alt="Logo"><a href="index.html" class="logo">CLICK<span>WORX</span></a></div>
<nav>
<ul>
<li><a href="index.html">Home</a></li>
<li><a href="urgent.html">Urgent Sale</a></li>
<li><a href="more.html" class="active">More Cars</a></li>
<li><a href="search.html">Search</a></li>
<li><a href="about.html">About Us</a></li>
<li><a href="contact.html">Contact Us</a></li>
<li><a href="admin.html" class="admin-link">Admin</a></li>
</ul>
</nav>
</header>

<section class="hero">
<div id="heroSlides"></div>
<div class="hero-content">
<h1>Explore More Cars</h1>
<p>Luxury, Performance & Style at ClickWorx</p>
</div>
<div class="dots" id="heroDots"></div>
</section>

<div class="content-wrapper">
<h2>More Cars Listing</h2>
<table class="car-table" id="moreCarsTable">
<thead>
<tr>
<th>Image</th>
<th>Name</th>
<th>Model</th>
<th>Specs</th>
<th>Mileage</th>
<th>Price</th>
<th>Action</th>
</tr>
</thead>
<tbody></tbody>
</table>
</div>

<!-- Modal -->
<div class="modal" id="carModal">
<div class="modal-content">
<span class="modal-close" onclick="closeModal()">&times;</span>
<div class="modal-left" id="modalImages"></div>
<div class="modal-right">
<h2 id="modalTitle"></h2>
<p id="modalDetails"></p>
<p id="modalPrice" style="color:#e50914;font-weight:700;"></p>
<button class="btn" onclick="openBuyForm()">I Want To Buy</button>
<div class="buy-form" id="buyForm">
<input type="text" id="carNameField" readonly>
<input type="text" id="customerName" placeholder="Your Name">
<input type="text" id="contactNo" placeholder="Contact No">
<textarea id="message" placeholder="Message"></textarea>
<button class="btn" onclick="sendWhatsApp()">Send via WhatsApp</button>
</div>
</div>
</div>
</div>

<script>
let moreCars = [];
let whatsappNumber = "";

// Load banners and cars
async function loadData(){
  let savedBanners = {};
  try{ const res = await fetch('banners.json'); if(res.ok) savedBanners = await res.json(); }catch{ savedBanners = JSON.parse(localStorage.getItem("banners"))||{}; }

  const heroContainer = document.getElementById("heroSlides");
  heroContainer.innerHTML="";
  const heroImages = [savedBanners.hero1,savedBanners.hero2,savedBanners.hero3,savedBanners.hero4].filter(Boolean);
  const fallback = ["images/BG/bg3.jpg","images/BG/car02.jpg","images/BG/car03.jpg","images/BG/bg1.jpg"];
  const slides = heroImages.length ? heroImages : fallback;

  slides.forEach((src,i)=>{
    const div=document.createElement("div");
    div.className="hero-slide";
    div.style.backgroundImage=`url(${src})`;
    if(i===0) div.classList.add("active");
    heroContainer.appendChild(div);
  });

  // dots
  const dotsContainer=document.getElementById("heroDots");
  dotsContainer.innerHTML="";
  slides.forEach((_,i)=>{
    const dot=document.createElement("span");
    dot.addEventListener("click",()=>showSlide(i));
    dotsContainer.appendChild(dot);
  });
  const dots=dotsContainer.querySelectorAll("span");

  let index=0;
  function showSlide(n){
    const allSlides=document.querySelectorAll(".hero-slide");
    allSlides.forEach(s=>s.classList.remove("active"));
    dots.forEach(d=>d.classList.remove("active"));
    index=(n+allSlides.length)%allSlides.length;
    allSlides[index].classList.add("active");
    dots[index].classList.add("active");
  }
  function nextSlide(){showSlide(index+1);}
  setInterval(nextSlide,5000);
  showSlide(0);

  // Load cars
  try{ const res = await fetch('cars.json'); if(res.ok) moreCars = await res.json(); else moreCars = JSON.parse(localStorage.getItem("cars"))||[]; }catch{ moreCars = JSON.parse(localStorage.getItem("cars"))||[]; }
  whatsappNumber = savedBanners.whatsapp || localStorage.getItem("+923330360487") || "";
  renderMoreCars();
}

function renderMoreCars(){
  const tbody = document.querySelector("#moreCarsTable tbody");
  tbody.innerHTML="";
  moreCars.filter(c=>c.category==="more").forEach((car,i)=>{
    const img = (car.images && car.images.length)?car.images[0]:(car.image||'');
    const tr = document.createElement("tr");
    tr.innerHTML=`
      <td><img src="${img}" class="car-image" alt="${car.name}"></td>
      <td>${car.name}</td>
      <td>${car.model}</td>
      <td>${car.specs||""}</td>
      <td>${car.mileage||""}</td>
      <td>${car.price}</td>
      <td><button class="btn" onclick="openModal(${i})">Details</button></td>
    `;
    tbody.appendChild(tr);
  });
}

// Modal functions
function openModal(index){
  const car = moreCars[index];
  document.getElementById('modalTitle').textContent = car.name+" - "+car.model;
  document.getElementById('modalDetails').textContent = car.details||"";
  document.getElementById('modalPrice').textContent = car.price;
  const imgs = (car.images&&car.images.length)?car.images:(car.image?[car.image]:[]);
  document.getElementById('modalImages').innerHTML = imgs.map(img=>`<img src="${img}" alt="${car.name}">`).join('');
  document.getElementById('carNameField').value = car.name;
  document.getElementById('carModal').style.display='flex';
}
function closeModal(){ document.getElementById('carModal').style.display='none'; document.getElementById('buyForm').style.display='none'; }
function openBuyForm(){ document.getElementById('buyForm').style.display='flex'; }
function sendWhatsApp(){
  const carName = document.getElementById('carNameField').value;
  const name = document.getElementById('customerName').value;
  const contact = document.getElementById('contactNo').value;
  const msg = document.getElementById('message').value;
  if(!whatsappNumber){ alert("WhatsApp number not set in admin panel."); return; }
  const text=`I Want To Buy: ${carName}%0AName: ${name}%0AContact: ${contact}%0AMessage: ${msg}`;
  window.open(`https://wa.me/${whatsappNumber}?text=${text}`,'_blank');
}

window.onload = loadData;
</script>
</body>
</html>
